{{template "p/header" .}}

<main class="container">
  <article>
    <h2>Recent Envelopes</h2>
    <figure>
      {{template "p/recent-envelopes-table" .}}
    </figure>
  </article>

  <article>
    <h2>Storage</h2>
    <figure>{{template "p/storage-table" .}}</figure>
    <div class="grid">
      <button hx-post="/vacuum" data-loading-path="/vacuum" data-loading-disable data-loading-aria-busy
        data-tooltip="Rebuild database file to take the minimal amount of disk space.">
        Vacuum Database
      </button>
      <button hx-delete="/envelopes" data-loading-path="/vacuum" data-loading-disable data-loading-aria-busy
        hx-confirm="Are you sure you wish to delete all envelopes?" class="contrast">
        Delete Envelopes
      </button>
    </div>
  </article>

  <article>
    <h2>Retention Policy</h2>
    <figure>
      <table>
        <tbody>
          <tr>
            <th scope="row"><strong>Minimum Age</strong></th>
            <td>{{.RetentionPolicy.MinAge}}</td>
          </tr>
          {{if not (eq .RetentionPolicy.EnvelopeCount nil)}}
          <tr>
            <th scope="row"><strong>Envelope Count</strong></th>
            <td>{{.RetentionPolicy.EnvelopeCount}}</td>
          </tr>
          {{end}}
          {{if not (eq .RetentionPolicy.EnvelopeAge nil)}}
          <tr>
            <th scope="row"><strong>Envelope Age</strong></th>
            <td>{{.RetentionPolicy.EnvelopeAge}}</td>
          </tr>
          {{end}}
          {{if not (eq .RetentionPolicy.AttachmentSize nil)}}
          <tr>
            <th scope="row"><strong>Attachment Size</strong></th>
            <td>{{bytesHumanize .RetentionPolicy.AttachmentSize}}</td>
          </tr>
          {{end}}
        </tbody>
      </table>
    </figure>
  </article>

  <article>
    <h2>Build</h2>
    <figure>
      <table>
        <tbody>
          <tr>
            <th scope="row"><strong>Built By</strong></th>
            <td>{{build.BuiltBy}}</td>
          </tr>
          <tr>
            <th scope="row"><strong>Commit</strong></th>
            <td><a href="{{build.CommitURL}}">{{build.Commit}}</a></td>
          </tr>
          <tr>
            <th scope="row"><strong>Date</strong></th>
            <td>{{build.Date}}</td>
          </tr>
          <tr>
            <th scope="row"><strong>Version</strong></th>
            <td>{{build.Version}}</td>
          </tr>
        </tbody>
      </table>
    </figure>
  </article>
</main>

{{template "p/footer" .}}
